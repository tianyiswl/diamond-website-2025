<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分类下拉框英文显示测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="mb-4">🧪 分类下拉框英文显示测试</h1>
        <p class="text-muted mb-4">测试JavaScript动态填充的分类下拉框是否显示英文</p>

        <!-- 模拟后台的分类下拉框 -->
        <div class="mb-3">
            <label for="product-category" class="form-label">产品分类 (JavaScript动态填充)</label>
            <select class="form-select" id="product-category" name="category">
                <!-- 这里会被JavaScript动态填充 -->
            </select>
        </div>

        <div class="mb-3">
            <label for="filter-category" class="form-label">筛选分类 (JavaScript动态填充)</label>
            <select class="form-select" id="filter-category" name="filter-category">
                <!-- 这里会被JavaScript动态填充 -->
            </select>
        </div>

        <button type="button" class="btn btn-primary" onclick="testCategoryFill()">
            🔄 重新填充分类选项
        </button>

        <div id="test-results" class="test-result" style="display: none;">
            <!-- 测试结果将显示在这里 -->
        </div>
    </div>

    <script>
        // 复制后台的静态分类数据 - 使用英文
        const staticCategories = [
            { id: 'all', name: 'All Products' },
            { id: 'turbocharger', name: 'Turbocharger' },
            { id: 'actuator', name: 'Actuator' },
            { id: 'injector', name: 'Common Rail Injector' },
            { id: 'turbo-parts', name: 'Turbo Parts' },
            { id: 'others', name: 'Others' }
        ];

        // 复制后台的填充分类筛选器函数
        function populateCategoryFilters() {
            const filterSelect = document.getElementById('filter-category');
            const formSelect = document.getElementById('product-category');

            if (filterSelect) {
                // 为产品筛选器设置选项（包含"所有分类"选项）
                filterSelect.innerHTML = staticCategories.map(cat =>
                    `<option value="${cat.id === 'all' ? '' : cat.id}">${cat.name}</option>`
                ).join('');
            }

            if (formSelect) {
                // 为添加产品表单设置选项（不包含"全部产品"选项）
                formSelect.innerHTML = staticCategories
                    .filter(cat => cat.id !== 'all')
                    .map(cat => `<option value="${cat.id}">${cat.name}</option>`)
                    .join('');

                // 设置默认值为涡轮增压器
                formSelect.value = 'turbocharger';
            }
        }

        // 测试函数
        function testCategoryFill() {
            console.log('🧪 开始测试分类填充...');
            
            // 执行填充函数
            populateCategoryFilters();
            
            // 检查结果
            const formSelect = document.getElementById('product-category');
            const filterSelect = document.getElementById('filter-category');
            const resultsDiv = document.getElementById('test-results');
            
            let testResults = [];
            let allPassed = true;
            
            // 检查产品分类下拉框
            if (formSelect && formSelect.options.length > 0) {
                const firstOption = formSelect.options[0];
                const isEnglish = firstOption.text === 'Turbocharger';
                testResults.push({
                    test: '产品分类下拉框',
                    expected: 'Turbocharger',
                    actual: firstOption.text,
                    passed: isEnglish
                });
                if (!isEnglish) allPassed = false;
            }
            
            // 检查筛选分类下拉框
            if (filterSelect && filterSelect.options.length > 0) {
                const firstOption = filterSelect.options[0];
                const isEnglish = firstOption.text === 'All Products';
                testResults.push({
                    test: '筛选分类下拉框',
                    expected: 'All Products',
                    actual: firstOption.text,
                    passed: isEnglish
                });
                if (!isEnglish) allPassed = false;
            }
            
            // 显示测试结果
            resultsDiv.style.display = 'block';
            resultsDiv.className = `test-result ${allPassed ? 'success' : 'error'}`;
            resultsDiv.innerHTML = `
                <h5>${allPassed ? '✅ 测试通过' : '❌ 测试失败'}</h5>
                <ul>
                    ${testResults.map(result => `
                        <li>
                            <strong>${result.test}</strong>: 
                            期望 "${result.expected}", 
                            实际 "${result.actual}" 
                            ${result.passed ? '✅' : '❌'}
                        </li>
                    `).join('')}
                </ul>
                <p class="mt-3">
                    <strong>结论</strong>: ${allPassed ? 
                        '分类下拉框现在正确显示英文选项！' : 
                        '分类下拉框仍然显示中文，需要进一步检查。'
                    }
                </p>
            `;
            
            console.log('🧪 测试结果:', testResults);
        }

        // 页面加载完成后自动执行测试
        document.addEventListener('DOMContentLoaded', function() {
            console.log('📋 页面加载完成，开始初始化测试...');
            testCategoryFill();
        });
    </script>
</body>
</html>
