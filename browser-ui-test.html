<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diamond Website æµè§ˆå™¨ç«¯UIåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .test-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .test-name {
            font-weight: 500;
            color: #333;
        }
        .test-result {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        .pass {
            background: #d4edda;
            color: #155724;
        }
        .fail {
            background: #f8d7da;
            color: #721c24;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
        }
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            display: block;
        }
        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        .test-frame {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 20px 0;
        }
        .controls {
            margin: 20px 0;
            text-align: center;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 14px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn.secondary {
            background: #6c757d;
        }
        .btn.secondary:hover {
            background: #545b62;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ¨ Diamond Website æµè§ˆå™¨ç«¯UIåŠŸèƒ½æµ‹è¯•</h1>
            <p>å®æ—¶æ£€æµ‹JavaScriptåŠ¨æ€åŠ è½½çš„é¡µé¢åŠŸèƒ½</p>
        </div>

        <div class="summary" id="summary">
            <h3>ğŸ“Š æµ‹è¯•ç»“æœæ¦‚è§ˆ</h3>
            <div class="summary-stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalTests">0</span>
                    <span class="stat-label">æ€»æµ‹è¯•æ•°</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="passedTests">0</span>
                    <span class="stat-label">é€šè¿‡</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="failedTests">0</span>
                    <span class="stat-label">å¤±è´¥</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="successRate">0%</span>
                    <span class="stat-label">æˆåŠŸç‡</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="runAllTests()">ğŸš€ å¼€å§‹æµ‹è¯•</button>
            <button class="btn secondary" onclick="clearLog()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
            <button class="btn secondary" onclick="exportReport()">ğŸ“„ å¯¼å‡ºæŠ¥å‘Š</button>
        </div>

        <iframe id="testFrame" class="test-frame" src="http://localhost:3001/" onload="onFrameLoad()"></iframe>

        <div class="test-section">
            <h3>ğŸ§­ é¡µé¢å¯¼èˆªæµ‹è¯•</h3>
            <div id="navigationTests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ–±ï¸ äº¤äº’åŠŸèƒ½æµ‹è¯•</h3>
            <div id="interactionTests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸŒ å¤šè¯­è¨€åŠŸèƒ½æµ‹è¯•</h3>
            <div id="multilangTests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“± å“åº”å¼è®¾è®¡æµ‹è¯•</h3>
            <div id="responsiveTests"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ˜Š ç”¨æˆ·ä½“éªŒæµ‹è¯•</h3>
            <div id="uxTests"></div>
        </div>

        <div class="log" id="testLog"></div>
    </div>

    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            tests: []
        };

        let testFrame = null;
        let frameDoc = null;

        function onFrameLoad() {
            testFrame = document.getElementById('testFrame');
            frameDoc = testFrame.contentDocument || testFrame.contentWindow.document;
            log('âœ… æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            
            // ç­‰å¾…JavaScriptç»„ä»¶åŠ è½½
            setTimeout(() => {
                log('â³ ç­‰å¾…JavaScriptç»„ä»¶åŠ è½½...');
                setTimeout(runAllTests, 2000);
            }, 1000);
        }

        function log(message) {
            const logElement = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function addTest(category, name, result, details = '') {
            testResults.total++;
            const test = {
                category,
                name,
                result: result ? 'PASS' : 'FAIL',
                details
            };
            testResults.tests.push(test);
            
            if (result) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }

            // æ›´æ–°UI
            const categoryElement = document.getElementById(category + 'Tests');
            const testItem = document.createElement('div');
            testItem.className = 'test-item';
            testItem.innerHTML = `
                <span class="test-name">${name}</span>
                <span class="test-result ${result ? 'pass' : 'fail'}">${result ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}</span>
            `;
            categoryElement.appendChild(testItem);

            // æ›´æ–°ç»Ÿè®¡
            updateSummary();
            
            log(`${result ? 'âœ…' : 'âŒ'} [${category.toUpperCase()}] ${name} - ${details}`);
        }

        function updateSummary() {
            document.getElementById('totalTests').textContent = testResults.total;
            document.getElementById('passedTests').textContent = testResults.passed;
            document.getElementById('failedTests').textContent = testResults.failed;
            const successRate = testResults.total > 0 ? ((testResults.passed / testResults.total) * 100).toFixed(1) : 0;
            document.getElementById('successRate').textContent = successRate + '%';
        }

        function runAllTests() {
            if (!frameDoc) {
                log('âŒ æµ‹è¯•é¡µé¢æœªåŠ è½½ï¼Œè¯·ç­‰å¾…...');
                return;
            }

            log('ğŸ¨ å¼€å§‹Diamond Websiteæµè§ˆå™¨ç«¯UIåŠŸèƒ½æµ‹è¯•...');
            
            // é‡ç½®ç»“æœ
            testResults = { total: 0, passed: 0, failed: 0, tests: [] };
            
            // æ¸…ç©ºæµ‹è¯•ç»“æœæ˜¾ç¤º
            ['navigation', 'interaction', 'multilang', 'responsive', 'ux'].forEach(category => {
                document.getElementById(category + 'Tests').innerHTML = '';
            });

            // è¿è¡Œå„ç±»æµ‹è¯•
            testNavigation();
            testInteraction();
            testMultiLanguage();
            testResponsive();
            testUserExperience();

            log('ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼');
        }

        function testNavigation() {
            log('ğŸ§­ å¼€å§‹é¡µé¢å¯¼èˆªæµ‹è¯•...');

            // æµ‹è¯•é¡µå¤´å®¹å™¨
            const headerContainer = frameDoc.getElementById('header-container');
            addTest('navigation', 'é¡µå¤´å®¹å™¨', !!headerContainer, headerContainer ? 'é¡µå¤´å®¹å™¨å­˜åœ¨' : 'é¡µå¤´å®¹å™¨ç¼ºå¤±');

            // æµ‹è¯•å¯¼èˆªèœå•
            const navMenu = frameDoc.querySelector('.nav-menu');
            addTest('navigation', 'å¯¼èˆªèœå•', !!navMenu, navMenu ? 'å¯¼èˆªèœå•å­˜åœ¨' : 'å¯¼èˆªèœå•ç¼ºå¤±');

            // æµ‹è¯•å¯¼èˆªé“¾æ¥
            const homeLink = frameDoc.querySelector('a[href*="index"], a[href="#home"]');
            addTest('navigation', 'é¦–é¡µé“¾æ¥', !!homeLink, homeLink ? 'é¦–é¡µé“¾æ¥å­˜åœ¨' : 'é¦–é¡µé“¾æ¥ç¼ºå¤±');

            const productsLink = frameDoc.querySelector('a[href*="products"]');
            addTest('navigation', 'äº§å“é¡µé¢é“¾æ¥', !!productsLink, productsLink ? 'äº§å“é¡µé¢é“¾æ¥å­˜åœ¨' : 'äº§å“é¡µé¢é“¾æ¥ç¼ºå¤±');

            const contactLink = frameDoc.querySelector('a[href*="contact"], a[href="#contact"]');
            addTest('navigation', 'è”ç³»æˆ‘ä»¬é“¾æ¥', !!contactLink, contactLink ? 'è”ç³»æˆ‘ä»¬é“¾æ¥å­˜åœ¨' : 'è”ç³»æˆ‘ä»¬é“¾æ¥ç¼ºå¤±');

            // æµ‹è¯•ç§»åŠ¨ç«¯èœå•æŒ‰é’®
            const mobileMenuBtn = frameDoc.querySelector('.mobile-menu-btn');
            addTest('navigation', 'ç§»åŠ¨ç«¯èœå•æŒ‰é’®', !!mobileMenuBtn, mobileMenuBtn ? 'ç§»åŠ¨ç«¯èœå•æŒ‰é’®å­˜åœ¨' : 'ç§»åŠ¨ç«¯èœå•æŒ‰é’®ç¼ºå¤±');
        }

        function testInteraction() {
            log('ğŸ–±ï¸ å¼€å§‹äº¤äº’åŠŸèƒ½æµ‹è¯•...');

            // æµ‹è¯•æœç´¢æ¡†
            const searchInput = frameDoc.getElementById('searchInput');
            addTest('interaction', 'æœç´¢è¾“å…¥æ¡†', !!searchInput, searchInput ? 'æœç´¢è¾“å…¥æ¡†å­˜åœ¨' : 'æœç´¢è¾“å…¥æ¡†ç¼ºå¤±');

            const searchBtn = frameDoc.querySelector('.search-btn');
            addTest('interaction', 'æœç´¢æŒ‰é’®', !!searchBtn, searchBtn ? 'æœç´¢æŒ‰é’®å­˜åœ¨' : 'æœç´¢æŒ‰é’®ç¼ºå¤±');

            // æµ‹è¯•ä¸‹æ‹‰èœå•
            const dropdown = frameDoc.querySelector('.dropdown-menu');
            addTest('interaction', 'ä¸‹æ‹‰èœå•', !!dropdown, dropdown ? 'ä¸‹æ‹‰èœå•å­˜åœ¨' : 'ä¸‹æ‹‰èœå•ç¼ºå¤±');

            // æµ‹è¯•è½®æ’­å›¾
            const carousel = frameDoc.querySelector('.carousel-container');
            addTest('interaction', 'è½®æ’­å›¾', !!carousel, carousel ? 'è½®æ’­å›¾å®¹å™¨å­˜åœ¨' : 'è½®æ’­å›¾å®¹å™¨ç¼ºå¤±');

            // æµ‹è¯•è”ç³»è¡¨å•
            const contactForm = frameDoc.querySelector('#contactForm');
            addTest('interaction', 'è”ç³»è¡¨å•', !!contactForm, contactForm ? 'è”ç³»è¡¨å•å­˜åœ¨' : 'è”ç³»è¡¨å•ç¼ºå¤±');
        }

        function testMultiLanguage() {
            log('ğŸŒ å¼€å§‹å¤šè¯­è¨€åŠŸèƒ½æµ‹è¯•...');

            // æµ‹è¯•è¯­è¨€åˆ‡æ¢å™¨
            const langSwitcher = frameDoc.querySelector('.language-switcher');
            addTest('multilang', 'è¯­è¨€åˆ‡æ¢å™¨', !!langSwitcher, langSwitcher ? 'è¯­è¨€åˆ‡æ¢å™¨å­˜åœ¨' : 'è¯­è¨€åˆ‡æ¢å™¨ç¼ºå¤±');

            const langSelect = frameDoc.getElementById('headerLanguageSelect');
            addTest('multilang', 'è¯­è¨€é€‰æ‹©ä¸‹æ‹‰æ¡†', !!langSelect, langSelect ? 'è¯­è¨€é€‰æ‹©ä¸‹æ‹‰æ¡†å­˜åœ¨' : 'è¯­è¨€é€‰æ‹©ä¸‹æ‹‰æ¡†ç¼ºå¤±');

            // æµ‹è¯•å¤šè¯­è¨€å±æ€§
            const i18nElements = frameDoc.querySelectorAll('[data-i18n]');
            addTest('multilang', 'å¤šè¯­è¨€å…ƒç´ ', i18nElements.length > 0, `æ‰¾åˆ° ${i18nElements.length} ä¸ªå¤šè¯­è¨€å…ƒç´ `);

            // æµ‹è¯•HTMLè¯­è¨€æ ‡è¯†
            const htmlLang = frameDoc.documentElement.getAttribute('lang');
            addTest('multilang', 'HTMLè¯­è¨€æ ‡è¯†', !!htmlLang, htmlLang ? `è¯­è¨€æ ‡è¯†: ${htmlLang}` : 'HTMLè¯­è¨€æ ‡è¯†ç¼ºå¤±');
        }

        function testResponsive() {
            log('ğŸ“± å¼€å§‹å“åº”å¼è®¾è®¡æµ‹è¯•...');

            // æµ‹è¯•viewport metaæ ‡ç­¾
            const viewport = frameDoc.querySelector('meta[name="viewport"]');
            addTest('responsive', 'Viewport Metaæ ‡ç­¾', !!viewport, viewport ? 'Viewport metaæ ‡ç­¾å­˜åœ¨' : 'Viewport metaæ ‡ç­¾ç¼ºå¤±');

            // æµ‹è¯•å“åº”å¼å®¹å™¨
            const containers = frameDoc.querySelectorAll('.container');
            addTest('responsive', 'å“åº”å¼å®¹å™¨', containers.length > 0, `æ‰¾åˆ° ${containers.length} ä¸ªå®¹å™¨å…ƒç´ `);

            // æµ‹è¯•ç§»åŠ¨ç«¯èœå•
            const mobileMenu = frameDoc.querySelector('.mobile-menu-btn');
            addTest('responsive', 'ç§»åŠ¨ç«¯èœå•', !!mobileMenu, mobileMenu ? 'ç§»åŠ¨ç«¯èœå•æŒ‰é’®å­˜åœ¨' : 'ç§»åŠ¨ç«¯èœå•æŒ‰é’®ç¼ºå¤±');

            // æµ‹è¯•å“åº”å¼å›¾ç‰‡
            const images = frameDoc.querySelectorAll('img');
            const responsiveImages = Array.from(images).filter(img => 
                img.style.maxWidth === '100%' || 
                img.classList.contains('img-responsive') ||
                img.hasAttribute('srcset')
            );
            addTest('responsive', 'å“åº”å¼å›¾ç‰‡', responsiveImages.length > 0, `æ‰¾åˆ° ${responsiveImages.length} ä¸ªå“åº”å¼å›¾ç‰‡`);
        }

        function testUserExperience() {
            log('ğŸ˜Š å¼€å§‹ç”¨æˆ·ä½“éªŒæµ‹è¯•...');

            // æµ‹è¯•é¡µé¢æ ‡é¢˜
            const title = frameDoc.title;
            addTest('ux', 'é¡µé¢æ ‡é¢˜', !!title && title.length > 0, title ? `é¡µé¢æ ‡é¢˜: ${title.substring(0, 50)}...` : 'é¡µé¢æ ‡é¢˜ç¼ºå¤±');

            // æµ‹è¯•Favicon
            const favicon = frameDoc.querySelector('link[rel*="icon"]');
            addTest('ux', 'Faviconå›¾æ ‡', !!favicon, favicon ? 'Faviconå›¾æ ‡å­˜åœ¨' : 'Faviconå›¾æ ‡ç¼ºå¤±');

            // æµ‹è¯•åŠ è½½æŒ‡ç¤ºå™¨
            const loadingElements = frameDoc.querySelectorAll('.loading, .spinner, .loading-text');
            addTest('ux', 'åŠ è½½æŒ‡ç¤ºå™¨', loadingElements.length > 0, `æ‰¾åˆ° ${loadingElements.length} ä¸ªåŠ è½½æŒ‡ç¤ºå™¨`);

            // æµ‹è¯•è¿”å›é¡¶éƒ¨æŒ‰é’®ï¼ˆå¯èƒ½é€šè¿‡JSåŠ¨æ€æ·»åŠ ï¼‰
            setTimeout(() => {
                const backToTop = frameDoc.getElementById('backToTop') || frameDoc.querySelector('.back-to-top');
                addTest('ux', 'è¿”å›é¡¶éƒ¨æŒ‰é’®', !!backToTop, backToTop ? 'è¿”å›é¡¶éƒ¨æŒ‰é’®å­˜åœ¨' : 'è¿”å›é¡¶éƒ¨æŒ‰é’®ç¼ºå¤±');
            }, 1000);

            // æµ‹è¯•å¯è®¿é—®æ€§å±æ€§
            const altImages = frameDoc.querySelectorAll('img[alt]');
            const ariaLabels = frameDoc.querySelectorAll('[aria-label]');
            const accessibilityCount = altImages.length + ariaLabels.length;
            addTest('ux', 'å¯è®¿é—®æ€§æ”¯æŒ', accessibilityCount > 0, `æ‰¾åˆ° ${accessibilityCount} ä¸ªå¯è®¿é—®æ€§å±æ€§`);
        }

        function clearLog() {
            document.getElementById('testLog').innerHTML = '';
        }

        function exportReport() {
            const report = {
                timestamp: new Date().toISOString(),
                testMethod: 'Browser-based Dynamic Content Testing',
                summary: {
                    total: testResults.total,
                    passed: testResults.passed,
                    failed: testResults.failed,
                    successRate: ((testResults.passed / testResults.total) * 100).toFixed(2) + '%'
                },
                tests: testResults.tests
            };

            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'browser-ui-test-report.json';
            a.click();
            URL.revokeObjectURL(url);
            
            log('ğŸ“„ æµ‹è¯•æŠ¥å‘Šå·²å¯¼å‡º');
        }
    </script>
</body>
</html>
