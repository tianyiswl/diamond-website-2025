// ğŸš€ æ— é”¡çš‡å¾·å›½é™…è´¸æ˜“æœ‰é™å…¬å¸ - Diamond Website æ•°æ®åº“æ¨¡å‹
// ä¸“ä¸ºæ¶¡è½®å¢å‹å™¨å’Œå…±è½¨å–·æ²¹å™¨é…ä»¶ä¸šåŠ¡è®¾è®¡çš„Prismaæ•°æ®æ¨¡å‹

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ğŸ“‚ äº§å“åˆ†ç±»è¡¨
model Category {
  id          String   @id @default(cuid())
  name        String   @unique // åˆ†ç±»åç§°ï¼ˆå¦‚ï¼šæ¶¡è½®å¢å‹å™¨ã€æ‰§è¡Œå™¨ç­‰ï¼‰
  description String?  // åˆ†ç±»æè¿°
  icon        String?  // åˆ†ç±»å›¾æ ‡
  color       String?  // åˆ†ç±»é¢œè‰²
  order       Int      @default(0) // æ˜¾ç¤ºé¡ºåº
  status      String   @default("active") // çŠ¶æ€ï¼šactive/inactive
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // å…³è”å…³ç³»
  products Product[] // ä¸€ä¸ªåˆ†ç±»å¯ä»¥æœ‰å¤šä¸ªäº§å“

  @@map("categories")
  @@index([status])
  @@index([order])
}

// ğŸ“¦ äº§å“è¡¨ - æ ¸å¿ƒä¸šåŠ¡æ•°æ®
model Product {
  id              String   @id @default(cuid())
  sku             String   @unique // äº§å“SKUç¼–å·
  name            String   // äº§å“åç§°
  model           String   // äº§å“å‹å·
  brand           String   @default("Diamond-Auto") // å“ç‰Œ
  description     String?  @db.Text // äº§å“è¯¦ç»†æè¿°
  price           Decimal  @default(0) @db.Decimal(10, 2) // ä»·æ ¼
  stock           Int      @default(0) // åº“å­˜æ•°é‡
  status          String   @default("active") // çŠ¶æ€ï¼šactive/inactive/draft
  
  // äº§å“è§„æ ¼ä¿¡æ¯
  oeNumber        String?  // OEå·ç 
  compatibility   String?  // å…¼å®¹æ€§ä¿¡æ¯
  warranty        Int      @default(12) // ä¿ä¿®æœŸï¼ˆæœˆï¼‰
  notes           String?  @db.Text // å¤‡æ³¨ä¿¡æ¯
  
  // SEOå’Œè¥é”€ä¿¡æ¯
  metaDescription String?  @db.Text // SEOæè¿°
  metaKeywords    String?  @db.Text // SEOå…³é”®è¯
  features        String?  // äº§å“ç‰¹æ€§ï¼ˆé€—å·åˆ†éš”ï¼‰
  badges          String?  // äº§å“æ ‡ç­¾
  
  // äº§å“æ ‡è®°
  isNew           Boolean  @default(false) // æ˜¯å¦æ–°å“
  isHot           Boolean  @default(false) // æ˜¯å¦çƒ­é”€
  isRecommend     Boolean  @default(false) // æ˜¯å¦æ¨è
  
  // æ—¶é—´æˆ³
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // å¤–é”®å…³ç³»
  categoryId      String
  category        Category @relation(fields: [categoryId], references: [id])
  
  // å…³è”å…³ç³»
  images          ProductImage[] // äº§å“å›¾ç‰‡
  inquiries       Inquiry[] // äº§å“è¯¢ä»·è®°å½•
  analytics       ProductAnalytics[] // äº§å“åˆ†ææ•°æ®

  @@map("products")
  @@index([categoryId])
  @@index([status])
  @@index([isNew])
  @@index([isHot])
  @@index([isRecommend])
  @@index([createdAt])
  @@index([name])
  @@index([oeNumber])
  @@index([compatibility])
}

// ğŸ–¼ï¸ äº§å“å›¾ç‰‡è¡¨
model ProductImage {
  id        String   @id @default(cuid())
  url       String   // å›¾ç‰‡URLè·¯å¾„
  alt       String?  // å›¾ç‰‡altæ–‡æœ¬
  order     Int      @default(0) // æ˜¾ç¤ºé¡ºåº
  isPrimary Boolean  @default(false) // æ˜¯å¦ä¸»å›¾
  size      Int?     // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  width     Int?     // å›¾ç‰‡å®½åº¦
  height    Int?     // å›¾ç‰‡é«˜åº¦
  createdAt DateTime @default(now())
  
  // å¤–é”®å…³ç³»
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_images")
  @@index([productId])
  @@index([isPrimary])
  @@index([order])
}

// ğŸ¢ å…¬å¸ä¿¡æ¯è¡¨
model Company {
  id            String   @id @default(cuid())
  name          String   // å…¬å¸å…¨ç§°
  shortName     String?  // å…¬å¸ç®€ç§°
  description   String?  // å…¬å¸æè¿°
  established   String?  // æˆç«‹å¹´ä»½
  experience    String?  // ç»éªŒå¹´æ•°
  logo          String?  // å…¬å¸Logoè·¯å¾„
  
  // è”ç³»ä¿¡æ¯
  phone         String?  // ç”µè¯
  email         String?  // é‚®ç®±
  whatsapp      String?  // WhatsApp
  address       String?  // åœ°å€
  website       String?  // ç½‘ç«™
  
  // ç¤¾äº¤åª’ä½“
  facebook      String?  // Facebooké“¾æ¥
  instagram     String?  // Instagramé“¾æ¥
  
  // è¥ä¸šæ—¶é—´
  weekdaysHours String?  // å·¥ä½œæ—¥è¥ä¸šæ—¶é—´
  weekendHours  String?  // å‘¨æœ«è¥ä¸šæ—¶é—´
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("company")
}

// ğŸ  è½®æ’­å›¾è¡¨
model CarouselSlide {
  id          String   @id @default(cuid())
  title       String   // æ ‡é¢˜
  description String?  // æè¿°
  image       String   // å›¾ç‰‡è·¯å¾„
  buttonText  String?  // æŒ‰é’®æ–‡å­—
  buttonLink  String?  // æŒ‰é’®é“¾æ¥
  alt         String?  // å›¾ç‰‡altæ–‡æœ¬
  order       Int      @default(0) // æ˜¾ç¤ºé¡ºåº
  status      String   @default("active") // çŠ¶æ€
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("carousel_slides")
  @@index([status])
  @@index([order])
}

// ğŸ“ å®¢æˆ·è¯¢ä»·è¡¨
model Inquiry {
  id          String   @id @default(cuid())
  customerName String  // å®¢æˆ·å§“å
  email       String   // å®¢æˆ·é‚®ç®±
  phone       String?  // å®¢æˆ·ç”µè¯
  company     String?  // å®¢æˆ·å…¬å¸
  country     String?  // å®¢æˆ·å›½å®¶
  message     String   @db.Text // è¯¢ä»·å†…å®¹
  quantity    Int?     // è¯¢ä»·æ•°é‡
  
  // è¯¢ä»·çŠ¶æ€
  status      String   @default("pending") // pending/replied/closed
  priority    String   @default("normal") // low/normal/high/urgent
  source      String   @default("website") // è¯¢ä»·æ¥æº
  
  // å¤„ç†ä¿¡æ¯
  assignedTo  String?  // åˆ†é…ç»™è°å¤„ç†
  reply       String?  @db.Text // å›å¤å†…å®¹
  repliedAt   DateTime? // å›å¤æ—¶é—´
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // å¤–é”®å…³ç³»ï¼ˆå¯é€‰ï¼‰
  productId   String?
  product     Product? @relation(fields: [productId], references: [id])

  @@map("inquiries")
  @@index([status])
  @@index([priority])
  @@index([createdAt])
  @@index([productId])
}

// ğŸ“Š äº§å“åˆ†ææ•°æ®è¡¨
model ProductAnalytics {
  id        String   @id @default(cuid())
  date      DateTime @default(now()) @db.Date // ç»Ÿè®¡æ—¥æœŸ
  views     Int      @default(0) // æµè§ˆæ¬¡æ•°
  inquiries Int      @default(0) // è¯¢ä»·æ¬¡æ•°
  searches  Int      @default(0) // æœç´¢æ¬¡æ•°
  
  // å¤–é”®å…³ç³»
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_analytics")
  @@unique([productId, date]) // æ¯ä¸ªäº§å“æ¯å¤©åªæœ‰ä¸€æ¡è®°å½•
  @@index([date])
  @@index([productId])
}

// ğŸ‘¤ ç®¡ç†å‘˜è¡¨
model Admin {
  id          String   @id @default(cuid())
  username    String   @unique // ç”¨æˆ·å
  email       String?  @unique // é‚®ç®±
  password    String   // åŠ å¯†åçš„å¯†ç 
  name        String?  // çœŸå®å§“å
  role        String   @default("admin") // è§’è‰²ï¼šadmin/super_admin
  permissions String[] // æƒé™åˆ—è¡¨
  
  // ç™»å½•ä¿¡æ¯
  lastLoginAt DateTime? // æœ€åç™»å½•æ—¶é—´
  loginCount  Int       @default(0) // ç™»å½•æ¬¡æ•°
  isActive    Boolean   @default(true) // æ˜¯å¦æ¿€æ´»
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("admins")
  @@index([username])
  @@index([isActive])
}

// ğŸ“ æ“ä½œæ—¥å¿—è¡¨
model OperationLog {
  id          String   @id @default(cuid())
  action      String   // æ“ä½œç±»å‹
  description String   // æ“ä½œæè¿°
  tableName   String?  // æ“ä½œçš„è¡¨å
  recordId    String?  // æ“ä½œçš„è®°å½•ID
  oldData     Json?    // æ“ä½œå‰æ•°æ®
  newData     Json?    // æ“ä½œåæ•°æ®
  ipAddress   String?  // IPåœ°å€
  userAgent   String?  // ç”¨æˆ·ä»£ç†
  
  // æ“ä½œè€…ä¿¡æ¯
  adminId     String?  // ç®¡ç†å‘˜ID
  adminName   String?  // ç®¡ç†å‘˜åç§°
  
  createdAt   DateTime @default(now())

  @@map("operation_logs")
  @@index([action])
  @@index([tableName])
  @@index([adminId])
  @@index([createdAt])
}

// ğŸ”§ ç³»ç»Ÿé…ç½®è¡¨
model SystemConfig {
  id        String   @id @default(cuid())
  key       String   @unique // é…ç½®é”®
  value     String   // é…ç½®å€¼
  type      String   @default("string") // å€¼ç±»å‹ï¼šstring/number/boolean/json
  category  String   @default("general") // é…ç½®åˆ†ç±»
  description String? // é…ç½®æè¿°
  isPublic  Boolean  @default(false) // æ˜¯å¦å…¬å¼€ï¼ˆå‰ç«¯å¯è®¿é—®ï¼‰
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("system_config")
  @@index([category])
  @@index([isPublic])
}
